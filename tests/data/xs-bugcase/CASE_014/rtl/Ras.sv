// Generated by CIRCT firtool-1.135.0

// Include register initializers in init blocks unless synthesis is set
`ifndef RANDOMIZE
  `ifdef RANDOMIZE_REG_INIT
    `define RANDOMIZE
  `endif // RANDOMIZE_REG_INIT
`endif // not def RANDOMIZE
`ifndef SYNTHESIS
  `ifndef ENABLE_INITIAL_REG_
    `define ENABLE_INITIAL_REG_
  `endif // not def ENABLE_INITIAL_REG_
`endif // not def SYNTHESIS

// Standard header to adapt well known macros for register randomization.

// RANDOM may be set to an expression that produces a 32-bit random unsigned value.
`ifndef RANDOM
  `define RANDOM $random
`endif // not def RANDOM

// Users can define INIT_RANDOM as general code that gets injected into the
// initializer block for modules with registers.
`ifndef INIT_RANDOM
  `define INIT_RANDOM
`endif // not def INIT_RANDOM

// If using random initialization, you can also define RANDOMIZE_DELAY to
// customize the delay used, otherwise 0.002 is used.
`ifndef RANDOMIZE_DELAY
  `define RANDOMIZE_DELAY 0.002
`endif // not def RANDOMIZE_DELAY

// Define INIT_RANDOM_PROLOG_ for use in our modules below.
`ifndef INIT_RANDOM_PROLOG_
  `ifdef RANDOMIZE
    `ifdef VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM
    `else  // VERILATOR
      `define INIT_RANDOM_PROLOG_ `INIT_RANDOM #`RANDOMIZE_DELAY begin end
    `endif // VERILATOR
  `else  // RANDOMIZE
    `define INIT_RANDOM_PROLOG_
  `endif // RANDOMIZE
`endif // not def INIT_RANDOM_PROLOG_
module Ras(
  input         clock,
  input         reset,
  input         io_specIn_valid,
  input  [1:0]  io_specIn_bits_attribute_rasAction,
  input  [4:0]  io_specIn_bits_cfiPosition,
  input  [49:0] io_specIn_bits_startPc,
  input         io_commit_valid,
  input  [3:0]  io_commit_bits_meta_ras_ssp,
  input         io_commit_bits_meta_ras_tosw_flag,
  input  [4:0]  io_commit_bits_meta_ras_tosw_value,
  input  [1:0]  io_commit_bits_attribute_rasAction,
  input         io_redirect_valid,
  input  [48:0] io_redirect_bits_cfiPc_addr,
  input  [1:0]  io_redirect_bits_attribute_rasAction,
  input  [3:0]  io_redirect_bits_meta_ras_ssp,
  input  [2:0]  io_redirect_bits_meta_ras_sctr,
  input         io_redirect_bits_meta_ras_tosw_flag,
  input  [4:0]  io_redirect_bits_meta_ras_tosw_value,
  input         io_redirect_bits_meta_ras_tosr_flag,
  input  [4:0]  io_redirect_bits_meta_ras_tosr_value,
  input         io_redirect_bits_meta_ras_nos_flag,
  input  [4:0]  io_redirect_bits_meta_ras_nos_value,
  output [48:0] io_topRetAddr_addr,
  output [3:0]  io_redirectMeta_ssp,
  output [2:0]  io_redirectMeta_sctr,
  output        io_redirectMeta_tosw_flag,
  output [4:0]  io_redirectMeta_tosw_value,
  output        io_redirectMeta_tosr_flag,
  output [4:0]  io_redirectMeta_tosr_value,
  output        io_redirectMeta_nos_flag,
  output [4:0]  io_redirectMeta_nos_value,
  output [48:0] io_redirectMeta_topRetAddr_addr,
  output [3:0]  io_commitMeta_ssp,
  output        io_commitMeta_tosw_flag,
  output [4:0]  io_commitMeta_tosw_value
);

  wire [48:0] _RasStack_io_spec_popAddr_addr;
  wire [3:0]  _RasStack_io_meta_ssp;
  wire        _RasStack_io_meta_tosw_flag;
  wire [4:0]  _RasStack_io_meta_tosw_value;
  wire        _RasStack_io_specNearOverflow;
  wire [49:0] _specPushAddr_T_3 =
    50'({io_specIn_bits_startPc[49:5], 5'h0}
        + 50'({44'h0, io_specIn_bits_cfiPosition, 1'h0} + 50'h2));
  reg         redirect_next_valid_last_REG;
  wire        redirect_next_valid_last_REG_probe = redirect_next_valid_last_REG;
  reg  [48:0] redirect_next_bits_r_cfiPc_addr;
  reg  [1:0]  redirect_next_bits_r_attribute_rasAction;
  reg  [3:0]  redirect_next_bits_r_meta_ras_ssp;
  reg  [2:0]  redirect_next_bits_r_meta_ras_sctr;
  reg         redirect_next_bits_r_meta_ras_tosw_flag;
  reg  [4:0]  redirect_next_bits_r_meta_ras_tosw_value;
  reg         redirect_next_bits_r_meta_ras_tosr_flag;
  reg  [4:0]  redirect_next_bits_r_meta_ras_tosr_value;
  reg         redirect_next_bits_r_meta_ras_nos_flag;
  reg  [4:0]  redirect_next_bits_r_meta_ras_nos_value;
  wire [49:0] _GEN = 50'({redirect_next_bits_r_cfiPc_addr, 1'h0} + 50'h2);
  reg         commitValid;
  reg  [3:0]  commitInfo_meta_ras_ssp;
  reg         commitInfo_meta_ras_tosw_flag;
  reg  [4:0]  commitInfo_meta_ras_tosw_value;
  reg  [1:0]  commitInfo_attribute_rasAction;
  always @(posedge clock or posedge reset) begin
    if (reset) begin
      redirect_next_valid_last_REG <= 1'h0;
      commitValid <= 1'h0;
    end
    else begin
      redirect_next_valid_last_REG <= io_redirect_valid;
      commitValid <= io_commit_valid;
    end
  end // always @(posedge, posedge)
  always @(posedge clock) begin
    if (io_redirect_valid) begin
      redirect_next_bits_r_cfiPc_addr <= io_redirect_bits_cfiPc_addr;
      redirect_next_bits_r_attribute_rasAction <= io_redirect_bits_attribute_rasAction;
      redirect_next_bits_r_meta_ras_ssp <= io_redirect_bits_meta_ras_ssp;
      redirect_next_bits_r_meta_ras_sctr <= io_redirect_bits_meta_ras_sctr;
      redirect_next_bits_r_meta_ras_tosw_flag <= io_redirect_bits_meta_ras_tosw_flag;
      redirect_next_bits_r_meta_ras_tosw_value <= io_redirect_bits_meta_ras_tosw_value;
      redirect_next_bits_r_meta_ras_tosr_flag <= io_redirect_bits_meta_ras_tosr_flag;
      redirect_next_bits_r_meta_ras_tosr_value <= io_redirect_bits_meta_ras_tosr_value;
      redirect_next_bits_r_meta_ras_nos_flag <= io_redirect_bits_meta_ras_nos_flag;
      redirect_next_bits_r_meta_ras_nos_value <= io_redirect_bits_meta_ras_nos_value;
    end
    if (io_commit_valid) begin
      commitInfo_meta_ras_ssp <= io_commit_bits_meta_ras_ssp;
      commitInfo_meta_ras_tosw_flag <= io_commit_bits_meta_ras_tosw_flag;
      commitInfo_meta_ras_tosw_value <= io_commit_bits_meta_ras_tosw_value;
      commitInfo_attribute_rasAction <= io_commit_bits_attribute_rasAction;
    end
  end // always @(posedge)
  `ifdef ENABLE_INITIAL_REG_
    `ifdef FIRRTL_BEFORE_INITIAL
      `FIRRTL_BEFORE_INITIAL
    `endif // FIRRTL_BEFORE_INITIAL
    logic [31:0] _RANDOM[0:20];
    initial begin
      `ifdef INIT_RANDOM_PROLOG_
        `INIT_RANDOM_PROLOG_
      `endif // INIT_RANDOM_PROLOG_
      `ifdef RANDOMIZE_REG_INIT
        for (logic [4:0] i = 5'h0; i < 5'h15; i += 5'h1) begin
          _RANDOM[i] = `RANDOM;
        end
        redirect_next_valid_last_REG = _RANDOM[5'h0][0];
        redirect_next_bits_r_cfiPc_addr = {_RANDOM[5'h0][31:1], _RANDOM[5'h1][17:0]};
        redirect_next_bits_r_attribute_rasAction = _RANDOM[5'h3][7:6];
        redirect_next_bits_r_meta_ras_ssp = _RANDOM[5'h11][12:9];
        redirect_next_bits_r_meta_ras_sctr = _RANDOM[5'h11][15:13];
        redirect_next_bits_r_meta_ras_tosw_flag = _RANDOM[5'h11][16];
        redirect_next_bits_r_meta_ras_tosw_value = _RANDOM[5'h11][21:17];
        redirect_next_bits_r_meta_ras_tosr_flag = _RANDOM[5'h11][22];
        redirect_next_bits_r_meta_ras_tosr_value = _RANDOM[5'h11][27:23];
        redirect_next_bits_r_meta_ras_nos_flag = _RANDOM[5'h11][28];
        redirect_next_bits_r_meta_ras_nos_value =
          {_RANDOM[5'h11][31:29], _RANDOM[5'h12][1:0]};
        commitValid = _RANDOM[5'h13][19];
        commitInfo_meta_ras_ssp = _RANDOM[5'h13][23:20];
        commitInfo_meta_ras_tosw_flag = _RANDOM[5'h13][24];
        commitInfo_meta_ras_tosw_value = _RANDOM[5'h13][29:25];
        commitInfo_attribute_rasAction = _RANDOM[5'h14][1:0];
      `endif // RANDOMIZE_REG_INIT
      if (reset) begin
        redirect_next_valid_last_REG = 1'h0;
        commitValid = 1'h0;
      end
    end // initial
    `ifdef FIRRTL_AFTER_INITIAL
      `FIRRTL_AFTER_INITIAL
    `endif // FIRRTL_AFTER_INITIAL
  `endif // ENABLE_INITIAL_REG_
  RasStack RasStack (
    .clock                       (clock),
    .reset                       (reset),
    .io_spec_fire                (io_specIn_valid),
    .io_spec_pushValid
      (io_specIn_valid & io_specIn_bits_attribute_rasAction == 2'h2
       & ~_RasStack_io_specNearOverflow),
    .io_spec_popValid
      (io_specIn_valid & io_specIn_bits_attribute_rasAction == 2'h1
       & ~_RasStack_io_specNearOverflow),
    .io_spec_pushAddr_addr       (_specPushAddr_T_3[49:1]),
    .io_spec_popAddr_addr        (_RasStack_io_spec_popAddr_addr),
    .io_commit_valid             (commitValid),
    .io_commit_pushValid         (commitValid & commitInfo_attribute_rasAction == 2'h2),
    .io_commit_popValid          (commitValid & commitInfo_attribute_rasAction == 2'h1),
    .io_commit_metaTosw_flag     (commitInfo_meta_ras_tosw_flag),
    .io_commit_metaTosw_value    (commitInfo_meta_ras_tosw_value),
    .io_commit_metaSsp           (commitInfo_meta_ras_ssp),
    .io_redirect_valid
      (redirect_next_valid_last_REG
       & (redirect_next_bits_r_meta_ras_tosw_flag ^ _RasStack_io_meta_tosw_flag
          ^ redirect_next_bits_r_meta_ras_tosw_value < _RasStack_io_meta_tosw_value
          | ~_RasStack_io_specNearOverflow)),
    .io_redirect_isCall          (redirect_next_bits_r_attribute_rasAction == 2'h2),
    .io_redirect_callAddr_addr   (_GEN[49:1]),
    .io_redirect_isRet           (redirect_next_bits_r_attribute_rasAction == 2'h1),
    .io_redirect_meta_ssp        (redirect_next_bits_r_meta_ras_ssp),
    .io_redirect_meta_sctr       (redirect_next_bits_r_meta_ras_sctr),
    .io_redirect_meta_tosw_flag  (redirect_next_bits_r_meta_ras_tosw_flag),
    .io_redirect_meta_tosw_value (redirect_next_bits_r_meta_ras_tosw_value),
    .io_redirect_meta_tosr_flag  (redirect_next_bits_r_meta_ras_tosr_flag),
    .io_redirect_meta_tosr_value (redirect_next_bits_r_meta_ras_tosr_value),
    .io_redirect_meta_nos_flag   (redirect_next_bits_r_meta_ras_nos_flag),
    .io_redirect_meta_nos_value  (redirect_next_bits_r_meta_ras_nos_value),
    .io_meta_ssp                 (_RasStack_io_meta_ssp),
    .io_meta_sctr                (io_redirectMeta_sctr),
    .io_meta_tosw_flag           (_RasStack_io_meta_tosw_flag),
    .io_meta_tosw_value          (_RasStack_io_meta_tosw_value),
    .io_meta_tosr_flag           (io_redirectMeta_tosr_flag),
    .io_meta_tosr_value          (io_redirectMeta_tosr_value),
    .io_meta_nos_flag            (io_redirectMeta_nos_flag),
    .io_meta_nos_value           (io_redirectMeta_nos_value),
    .io_specNearOverflow         (_RasStack_io_specNearOverflow)
  );
  assign io_topRetAddr_addr = _RasStack_io_spec_popAddr_addr;
  assign io_redirectMeta_ssp = _RasStack_io_meta_ssp;
  assign io_redirectMeta_tosw_flag = _RasStack_io_meta_tosw_flag;
  assign io_redirectMeta_tosw_value = _RasStack_io_meta_tosw_value;
  assign io_redirectMeta_topRetAddr_addr = _RasStack_io_spec_popAddr_addr;
  assign io_commitMeta_ssp = _RasStack_io_meta_ssp;
  assign io_commitMeta_tosw_flag = _RasStack_io_meta_tosw_flag;
  assign io_commitMeta_tosw_value = _RasStack_io_meta_tosw_value;
endmodule

